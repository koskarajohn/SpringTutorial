<!DOCTYPE html>
<html>
  <head>
    <title>Angular - search-sidebar</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/index.css">
    
    <script src="../js/jquery.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
  </head>

  <body>

     <nav class="navbar navbar-expand-md fixed-top" id="mainNav">

        <div class="container">
            <a class="navbar-brand" href="../index.html">SpringTutorial</a>

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarContent" aria-controls="navbarContent" aria-expanded="false">
                <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarContent">
            <ul class="navbar-nav ml-5">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarSpring" data-toggle="dropdown">Θεωρία Spring</a>
                    <ul class="dropdown-menu">
                        <li> <a class="dropdown-item" href="spring.html">Τι είναι το Spring</a> </li>  
                        <li><a class="dropdown-item" href="spring-container.html">Spring IoC Container</a>  </li>  
                        <li>  <a class="dropdown-item" href="spring-beans.html">Spring Beans</a> </li> 
                        <li> <a class="dropdown-item" href="dependency-injection.html">Dependency Injection</a>  </li> 
                        <li> <a class="dropdown-item" href="annotations.html">Annotations</a> </li>  
                        <li> <a class="dropdown-item" href="spring-boot.html">Spring Boot</a> </li>  
                        <li> <a class="dropdown-item" href="spring-mvc.html">Spring Mvc</a> </li>  
                        <li>  <a class="dropdown-item" href="spring-security.html">Spring Security</a> </li> 
                        <li> <a class="dropdown-item" href="rest-api.html">Rest API</a>  </li> 
                        <li><a class="dropdown-item" href="application-properties.html">Application Properties</a>  </li>  
                    </ul>
                </li>
                <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle" href="#" id="navbarJpa" data-toggle="dropdown">JPA</a>
                  <ul class="dropdown-menu">
                       <li> <a class="dropdown-item" href="jpa.html">JPA</a> </li>       
                       <li>  <a class="dropdown-item" href="spring-data-jpa.html">Spring Data Jpa</a> </li>      
                  </ul>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarSetup" data-toggle="dropdown">Setup εφαρμογης</a>
                    <ul class="dropdown-menu">
                      <li> <a class="dropdown-item" href="app-architecture.html">Αρχιτεκτονική εφαρμογής</a> </li>        
                      <li>  <a class="dropdown-item" href="spring-tool-suite.html">Spring Tool Suite</a> </li>       
                      <li> <a class="dropdown-item" href="heroku.html">Heroku</a>  </li>       
                      <li>  <a class="dropdown-item" href="postgresql.html">Postgres</a> </li>       
                      <li> <a class="dropdown-item" href="amazon-s3.html">Amazon S3</a> </li>        
                      <li>  <a class="dropdown-item" href="angular.html">Angular</a> </li>      
                      <li> <a class="dropdown-item" href="create-frontend.html">Δημιουργία Frontend</a>   </li>      
                      <li>  <a class="dropdown-item" href="visual-studio-code.html">Visual Studio Code</a> </li>      
                    </ul>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarCreateApp" data-toggle="dropdown">Κώδικας εφαρμογης</a>
                    <ul class="dropdown-menu">
                        <li class="nav-item dropleft submenu">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarSpring" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Spring</a>
                            <ul class="dropdown-menu">
                                <li> <a class="dropdown-item" href="jpa-configuration.html">Ρύθμιση βάσης δεδομένων και JPA</a> </li>  
                                <li>  <a class="dropdown-item" href="amazons3-configuration.html">Ρύθμιση Amazon S3</a> </li>     
                                <li>  <a class="dropdown-item" href="upload-images.html">Ανέβασμα εικόνων στο Amazon S3</a> </li>   
                                <li>  <a class="dropdown-item" href="create-tables-for-products.html">Δημιουργία πινάκων products, categories, brands, product_images, inventory</a> </li>    
                               <li> <a class="dropdown-item" href="create-components-products.html">Δημιουργία repositories, services για τους πίνακες brands, categories...</a> </li>      
                               <li> <a class="dropdown-item" href="insert-products.html">Δημιουργία controller,repository, service για την εισαγωγή προϊόντων</a> </li>     
                                <li>  <a class="dropdown-item" href="create-tables-deals.html">Δημιουργία πινάκων deals, deal_images</a> </li>    
                               <li> <a class="dropdown-item" href="create-components-deals.html">Δημιουργία controller,repository, service για την ανάκτηση προσφορών</a> </li>  
                            </ul>
                        </li>
                       
                        <li class="nav-item dropleft submenu">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarAngular" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Spring - Angular</a>
                            <ul class="dropdown-menu">
                               <li> <a class="dropdown-item" href="angular-routes.html">Angular - Routes</a> </li>     
                               <li>  <a class="dropdown-item" href="create-common-components.html">Angular - Components my-footer, shop-services, navigation-bar και product</a> </li>     
                               <li>  <a class="dropdown-item" href="create-index-page.html">Angular - index-page</a> </li>    
                               <li> <a class="dropdown-item" href="create-component-product-page.html">Angular - product-page</a> </li>      
                               <li>  <a class="dropdown-item" href="create-component-category.html">Angular - category-page</a> </li>    
                               <li>  <a class="dropdown-item" href="create-component-sidebar.html">Angular - category-sidebar</a> </li>     
                              <li>    <a class="dropdown-item" href="refresh-category-products.html">Angular - ανανέωση προϊόντων κατηγορίας</a></li>   
                              <li>  <a class="dropdown-item" href="spring-security-and-session.html">Spring Security - Spring Session</a> </li>    
                              <li><a class="dropdown-item" href="create-component-register.html">Angular - register-page component</a>  </li>     
                              <li> <a class="dropdown-item" href="create-component-login.html">Angular - login-page, navigation-bar components (είσοδος και αποσύνδεση)</a>  </li>
                              <li> <a class="dropdown-item" href="create-components-cart.html">Angular - cart-page component</a>  </li>
                              <li> <a class="dropdown-item" href="create-component-checkout.html">Angular - checkout-page component</a>  </li>
                              <li> <a class="dropdown-item" href="create-component-order.html">Angular - order-page component</a>  </li>
                              <li> <a class="dropdown-item" href="spring-email.html">Spring Email - αποστολή E-mail</a>  </li>
                              <li> <a class="dropdown-item" href="create-component-search.html">Angular - search-page</a>  </li>
                              <li> <a class="dropdown-item" href="create-component-search-sidebar.html">Angular - search-sidebar</a>  </li>
                            </ul>
                        </li>  
                    </ul>
                </li>

            </ul>
        </div>
      </div>
   
    </nav>

    <div class="container">

        <h1 class="text-center">Angular - search-sidebar</h1>

        <section class="intro">
            <p>Θα δημιουργήσουμε το search-sidebar component, το οποίο περιέχει δύο φίλτρα για τα προϊόντα. Ο χρήστης θα μπορεί, να αναζητήσει προϊόντα
                συγκεκριμένων εταιριών ή/και μέσα σε ένα συγκεκριμένο διάστημα τιμών(10-20ευρώ).
            </p>

            <h5>Εταιρίες</h5>

            <p>Για την αρχικοποίηση των τιμών των φίλτρων, ο client θα ζητάει τον αριθμό των προϊόντων της κάθε εταιρίας.
                Αν επιλεχθεί κάποιο φίλτρο από τα διαστήματα τιμών μετά, τότε στέλνει μια παράμετρο range, για να πάρει τον αριθμό των 
                προϊόντων της κάθε εταιρίας, σε ένα διάστημα τιμών.
            </p>

            <ul>
                <li>αρχικό αίτημα, για την εταιρία Solgar : HTTP GET http://localhost:8080/api/search/brands/Solgar/products/count</li>
                <li>αριθμός προϊόντων εταιρίας Solgar, στα διαστήματα 0 - 9.99, 10 - 19.99 : HTTP GET http://localhost:8080/api/categories/search/Solgar/products/count?range=1&range=2</li>
            </ul>

            <h5>Διαστήματα τιμών</h5>

            <p>Για την αρχικοποίηση των τιμών των φίλτρων, ο client θα ζητάει τον αριθμό των προϊόντων ανά διάστημα τιμών.
                Αν επιλεχθεί κάποιο φίλτρο από τις εταιρίες μετά, τότε στέλνει μια παράμετρο brand, για να πάρει τον αριθμό των 
                προϊόντων στο συγκεκριμένο διάστημα τιμών, που ανήκουν σε αυτές τις εταιρίες.
            </p>

            <ul>
                <li>αρχικό αίτημα, για το διάστημα 0 - 9.99 : HTTP GET http://localhost:8080/api/search/ranges/1/products/count</li>
                <li>αριθμός προϊόντων εταιρίων Solgar και Solaray, στο διαστήμα 0 - 9.99 : HTTP GET http://localhost:8080/api/search/ranges/1/products/count?brand=Solgar&brand=Solaray</li>
            </ul>
        </section>

        <section class="spring-boot-brands">
            <h5>Spring Boot</h5>

            <p>Υλοποιούμε τη μέθοδο List&#60;Brand&#62; findSearchBrands(String[] searchTerms) {</p>
    
                 <pre>
                    <code>
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="annotation">@Override</span>
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="keyword">public</span> List&#60;Brand&#62; findSearchBrands(String[] searchTerms) {
    
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;CriteriaBuilder criteriaBuilder = entityManager.getCriteriaBuilder();
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;CriteriaQuery&#60;Brand&#62; criteriaQuery = criteriaBuilder.createQuery(Brand.class);
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;Root&#60;Product&#62; productsRoot = criteriaQuery.from(Product.class);
                    </code>
                </pre>
    
                <p class="mt-5">Δημιουργούμε τη συνθήκη του WHERE "prod.name like '%' + :searchTerm  + '%' "</p>
    
                <pre>
                    <code>
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;List&#60;Predicate&#62; searchPredicatesList = new ArrayList&#60;&#62;();

                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;if(searchTerms.length > 0){
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;for(String term : searchTerms){
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;searchPredicatesList.add(criteriaBuilder.like(productsRoot.get("name"), "%" + term +"%"));
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;}
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;}

                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;Predicate[] searchPredicatesArray = new Predicate[searchPredicatesList.size()];
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;searchPredicatesList.toArray(searchPredicatesArray);
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;Predicate searchPredicate = criteriaBuilder.or(searchPredicatesArray);
                    </code>
                </pre>
    
                <p class="mt-5">Εκτελούμε το ερώτημα και επιστρέφουμε τις εταιρίες</p>
    
                <pre>
                    <code>
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;criteriaQuery.select(productsRoot.get("brand")).distinct(true);
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;criteriaQuery.where(criteriaBuilder.and(searchPredicate));
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;criteriaQuery.orderBy(criteriaBuilder.asc(productsRoot.get("brand").get("name")));
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;List&#60;Brand&#62; brands = entityManager.createQuery(criteriaQuery).getResultList();
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;return brands;
                    </code>
                </pre>

             <p class="mt-5">Υλοποιούμε τη μέθοδο int findSearchProductsNumberByRange(String[] searchTerms, double min, double max, List&#60;Brand&#62; brands) {</p>
    
                 <pre>
                    <code>
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="annotation">@Override</span>
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="keyword">public</span> int findSearchProductsNumberByRange(String[] searchTerms, double min, double max, List&#60;Brand&#62; brands) {
    
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;CriteriaBuilder criteriaBuilder = entityManager.getCriteriaBuilder();
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;CriteriaQuery&#60;Product&#62; criteriaQuery = criteriaBuilder.createQuery(Product.class);
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;Root&#60;Product&#62; productsRoot = criteriaQuery.from(Product.class);
                    </code>
                </pre>
    
                <p class="mt-5">Δημιουργούμε τις συνθήκες του WHERE "prod.name like '%' + :searchTerm  + '%' ", "prod.price between :range1 and :range2"</p>
    
                <pre>
                    <code>
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;List&#60;Predicate&#62; searchPredicatesList = new ArrayList&#60;&#62;();

                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;if(searchTerms.length > 0){
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;for(String term : searchTerms){
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;searchPredicatesList.add(criteriaBuilder.like(productsRoot.get("name"), "%" + term +"%"));
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;}
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;}

                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;Predicate[] searchPredicatesArray = new Predicate[searchPredicatesList.size()];
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;searchPredicatesList.toArray(searchPredicatesArray);

                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;Predicate brandsPredicate = criteriaBuilder.or(brandsPredicateArray);
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;Predicate priceRangePredicate = criteriaBuilder.between(productsRoot.get("price"), min, max);
                    </code>
                </pre>
    
                <p class="mt-5">Δημιουργούμε το κατάλληλο ερώτημα, ανάλογα με το αν είναι επιλεγμένο τo φίλτρo των εταιριών </p>
    
                <pre>
                    <code>
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;if(!brands.isEmpty()){
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;List&#60;Predicate&#62; brandPredicateList = new ArrayList&#60;&#62;();

                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;for(int i=0; i &#60; brands.size(); i++){
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;brandPredicateList.add(criteriaBuilder.equal(productsRoot.get("brand"), brands.get(i)));
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;}

                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;Predicate[] brandsPredicateArray = new Predicate[brandPredicateList.size()];
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;brandPredicateList.toArray(brandsPredicateArray);

                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;Predicate brandsPredicate = criteriaBuilder.or(brandsPredicateArray);
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;criteriaQuery.where(criteriaBuilder.and(searchPredicate, priceRangePredicate, brandsPredicate));
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;}else{
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;criteriaQuery.where(criteriaBuilder.and(searchPredicate, priceRangePredicate));
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;}
                    </code>
                </pre>
    
                <p class="mt-5">Βρίσκουμε τον αριθμό και τον επιστρέφουμε</p>
    
                <pre>
                    <code>
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;int number = 0;
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;number = entityManager.createQuery(criteriaQuery).getResultList().size();
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;return number;
                    </code>
                </pre>

            <p class="mt-5">Υλοποιούμε τη μέθοδο int findSearchProductsNumberByBrand(String[] searchTerms, Brand brand, List&#60;double[]&#62; priceRanges) {</p>
    
                 <pre>
                    <code>
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="annotation">@Override</span>
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="keyword">public</span> int findSearchProductsNumberByBrand(String[] searchTerms, Brand brand, List&#60;double[]&#62; priceRanges)) {
    
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;CriteriaBuilder criteriaBuilder = entityManager.getCriteriaBuilder();
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;CriteriaQuery&#60;Product&#62; criteriaQuery = criteriaBuilder.createQuery(Product.class);
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;Root&#60;Product&#62; productsRoot = criteriaQuery.from(Product.class);
                    </code>
                </pre>
    
                <p class="mt-5">Δημιουργούμε τη συνθήκη WHERE "prod.name like '%' + :searchTerm  + '%' "</p>
    
                <pre>
                    <code>
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;List&#60;Predicate&#62; searchPredicatesList = new ArrayList&#60;&#62;();

                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;if(searchTerms.length > 0){
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;for(String term : searchTerms){
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;searchPredicatesList.add(criteriaBuilder.like(productsRoot.get("name"), "%" + term +"%"));
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;}
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;}

                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;Predicate[] searchPredicatesArray = new Predicate[searchPredicatesList.size()];
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;searchPredicatesList.toArray(searchPredicatesArray);

                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;Predicate brandPredicate = criteriaBuilder.equal(productsRoot.get("brand"), brand);
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;Predicate searchPredicate = criteriaBuilder.or(searchPredicatesArray);
                    </code>
                </pre>
    
                <p class="mt-5">Δημιουργούμε το κατάλληλο ερώτημα, ανάλογα με το αν είναι επιλεγμένο τo φίλτρo των τιμών </p>
    
                <pre>
                    <code>
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;if(priceRanges.isEmpty())){
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;criteriaQuery.where(criteriaBuilder.and(searchPredicate, brandPredicate));
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;}else{
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;List&#60;Predicate&#62; priceRangePredicateList = new ArrayList&#60;&#62;();

                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;for(double[] range : priceRanges){
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;priceRangePredicateList.add(criteriaBuilder.between(productsRoot.get("price"), range[0], range[1]));
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;}

                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;Predicate[] priceRangePredicateArray = new Predicate[priceRangePredicateList.size()];
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;priceRangePredicateList.toArray(priceRangePredicateArray);

                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;Predicate priceRangePredicate = criteriaBuilder.or(priceRangePredicateArray);
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;criteriaQuery.where(criteriaBuilder.and(searchPredicate, brandPredicate, priceRangePredicate));
                           
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;}
                    </code>
                </pre>
    
                <p class="mt-5">Βρίσκουμε τον αριθμό και τον επιστρέφουμε</p>
    
                <pre>
                    <code>
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;int number = 0;
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;number = entityManager.createQuery(criteriaQuery).getResultList().size();
                            &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;return number;
                    </code>
                </pre>

            <h5 class="mt-5">SearchApiController</h5>
                
           <p>Προσθέτουμε τη μέθοδο getCategoryBrandProductsNumber στον SearchApiController. </p>

            <pre>
                <code>
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="annotation">@RequestMapping(</span>value = <span class="string">"/search/brands/{brandname}/products/count"</span>, method = RequestMethod.GET)
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="keyword">public</span> ResponseEntity&#60;?&#62; getSearchProducts(<span class="annotation">@PathVariable(</span>(<span class="string">value</span> = "brandname") String brandname, 
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="annotation">@RequestParam(</span> (<span class="string">value</span> = "range", required = false) String[] ranges, 
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="annotation">@RequestParam(</span> (<span class="string">value</span> = "keywords") String[] keywords){

                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;int productsNumber = 0;

                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;if(!brandService.doesBrandExist(brandname)){
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="keyword">return new</span> ResponseEntity&#60;&#62;(HttpStatus.BAD_REQUEST.OK);
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;}

                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;List&#60;double[]&#62; priceRangeList = new ArrayList&#60;&#62;();

                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;if(ranges != null){
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;for(String range : ranges){
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;rangeValues[0] = getRangeMin(range);
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;rangeValues[1] = getRangeMax(range);
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;priceRangeList.add(rangeValues);
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;}
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;}

                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;productsNumber = searchService.findSearchProductsNumberByBrand(keywords,  brandService.findByName(brandname), priceRangeList);

                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;ProductsPerBrand pNumber =  new ProductsPerBrand();
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;pNumber.setNumber(productsNumber);
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;pNumber.setBrand(brandname);

                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="keyword">return new</span> ResponseEntity&#60;ProductsPerBrand&#62;(pNumber, HttpStatus.OK);
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;}
                </code>
            </pre>

            <p class="mt-5">Προσθέτουμε τη μέθοδο getSearchProductsNumbersByRange στον SearchApiController. </p>

            <pre>
                <code>
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="annotation">@RequestMapping(</span>value = <span class="string">"/search/ranges/{rangeid}/products/count"</span>, method = RequestMethod.GET)
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="keyword">public</span> ResponseEntity&#60;?&#62; getSearchProductsNumbersByRange(<span class="annotation">@PathVariable(</span>(value =<span class="string"></span>  "rangeid") String rangeid, 
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="annotation">@RequestParam(</span> (value =<span class="string">"brand"</span> , required = false) String[] brands, 
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="annotation">@RequestParam(</span> (value =<span class="string">"keywords"</span> ) String[] keywords){

                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;ProductsPerPriceRange ppNumber = new ProductsPerPriceRange();
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;List&#60;Brand&#62; brandList = new ArrayList&#60;&#62;();

                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;if(brands != null){
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;brandList = brandService.findSpecificBrands(brands);
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;}

                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;List&#60;double[]&#62; priceRangeList = new ArrayList&#60;&#62;();

                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;ppNumber.setNumber(searchService.findSearchProductsNumberByRange(keywords, getRangeMin(rangeid), getRangeMax(rangeid), brandList));
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;ppNumber.setMin(getRangeMin(rangeid));
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;ppNumber.setMax(getRangeMax(rangeid));
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;ppNumber.setRangeId(Integer.parseInt(rangeid));

                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="keyword">return new</span> ResponseEntity&#60;ProductsPerPriceRange&#62;(ppNumber, HttpStatus.OK);
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;}
                </code>
            </pre>

            <p class="mt-5">Προσθέτουμε τη μέθοδο getSearchProductsBrands στον SearchApiController. </p>

            <pre>
                <code>
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="annotation">@RequestMapping(</span>value = <span class="string">"/search/brands"</span>, method = RequestMethod.GET)
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="keyword">public</span> ResponseEntity&#60;?&#62; getSearchProductsBrands( <span class="annotation">@RequestParam(</span> (value =<span class="string">"keywords"</span> ) String[] keywords){

                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;List&#60;Brand&#62; brandList = searchService.findSearchBrands(keywords);

                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;if(brands.isEmpty()){
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="keyword">return new</span> ResponseEntity&#60;&#62;(HttpStatus.NO_CONTENT);
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;}

                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<span class="keyword">return new</span> ResponseEntity&#60;List&#60;Brand&#62;&#62;(brands, HttpStatus.OK;
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;}
                </code>
            </pre>

        </section>

        <section class="angular">
                <h5>search-sidebar component</h5>

                <p>Δημιουργούμε το component search-sidebar.
                </p>

                <pre>
                    <code>
                            &emsp;&emsp;&emsp;&emsp;ng generate component search-sidebar
                    </code>
                </pre>

                <p>search.service.ts</p>

                <img class="img-fluid mx-auto my-5" src="../img/search-service-2.PNG" alt="Search Service 2">

                <p>search-sidebar.component.html</p>

                <p>Το html αρχείο περιέχει δύο λίστες με checkboxes.</p>

                <img class="img-fluid mx-auto my-5" src="../img/search-sidebar-html.PNG" alt="Search Sidebar Html">

                <p>search-sidebar.component.css</p>

                <img class="img-fluid mx-auto my-5" src="../img/search-sidebar-css.PNG" alt="Search Sidebar Css">

                <p>Κάθε φορά που ο χρήστης πραγματοτοποιεί αναζήτηση, καλείται η μέθοδος ngOnChanges(), η οποία καλεί την updateSidebar(), για να
                     πραγματοποίησει τα HTTP αιτήματα και να αρχικοποιήσει τα φίλτρα. 
                </p>
                
                <p>search-sidebar.component.ts</p>

                <img class="img-fluid mx-auto my-5" src="../img/search-sidebar-ts.PNG" alt="Search sidebar Ts">
                
                <p>Όταν ο χρήστης κάνει κλικ σε κάποια εταιρία (event), εκτελείται η μέθοδος onSelectedBrand(), η οποία ενημερώνει τον
                    αριθμό των προϊόντων ανα διάστημα τιμών. Αντίστοιχα, όταν κάνει κλικ σε κάποιο διάστημα (event), 
                    εκτελείται η μέθοδος onSelectedPriceRange(), η οποία ενημερώνει τον αριθμό των προϊόντων ανα εταιρία.
                </p>

                <img class="img-fluid mx-auto my-5" src="../img/update-sidebar-.PNG" alt="Update Ts">
                
        </section>

        <section class="appearance">

            <h5>Τελική εμφάνιση σελίδας</h5>

            <img class="img-fluid mx-auto my-5" src="../img/search-sidebar-appearance.PNG" alt="Search Image">
        </section>
    </div>

  </body>
</html>